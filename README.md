# 🥬 양배추 도매가격 예측 AI 모델

농산물(양배추) 도매가격 7일 후 예측을 위한 **LightGBM + LSTM 앙상블 모델**

## 📊 모델 성능

| 등급 | LightGBM R² | LSTM R² | **앙상블 R²** |
|------|-------------|---------|---------------|
| 특   | ~0.65       | ~0.55   | **0.70+**     |
| 상   | ~0.65       | ~0.55   | **0.69+**     |

## 🏗️ 프로젝트 구조

```
📦 agri-forecast-cabbage-AI
├── 📄 model_lightgbm_lstm.py         # 🎯 최종 앙상블 모델
├── 📄 feature_engineering_지역별.py  # 피처 엔지니어링
├── 📄 양배추_학습데이터_지역별.csv   # 학습 데이터
├── 📄 requirements.txt               # 의존성 패키지
│
├── 📂 preprocessing/                 # 데이터 전처리
│   ├── 양배추가격_전처리.py
│   ├── 양배추 반입량 합치기1.py
│   ├── 양배추 유가 합치기2.py
│   ├── 양배추 수출입 합치기3.py
│   └── 양배추 날씨 합치기4.py
│
├── 📂 eda/                           # EDA & 분석
│   ├── 양배추_EDA.py
│   └── feature_analysis.py
│
└── 📂 results/                       # 결과 시각화
    ├── result_lgb_lstm_특_등급.png
    └── result_lgb_lstm_상_등급.png
```

## 🔧 모델 아키텍처

### LightGBM + LSTM 앙상블

```
┌─────────────────────────────────────────────────┐
│                   입력 데이터                      │
│        (양배추_학습데이터_지역별.csv)               │
└─────────────────┬───────────────────────────────┘
                  │
        ┌─────────┴─────────┐
        │                   │
        ▼                   ▼
┌───────────────┐   ┌───────────────┐
│   LightGBM    │   │     LSTM      │
│  (28개 피처)   │   │  (12개 피처)   │
│               │   │               │
│ • 가격 지표    │   │ • 핵심 시계열  │
│ • 반입량/수입  │   │ • 가격 MA/RSI │
│ • 기상 데이터  │   │ • 계절성      │
│ • 생육기 지표  │   │               │
└───────┬───────┘   └───────┬───────┘
        │                   │
        └─────────┬─────────┘
                  │
                  ▼
        ┌─────────────────┐
        │  최적 가중치 탐색  │
        │  (Grid Search)   │
        └────────┬────────┘
                 │
                 ▼
        ┌─────────────────┐
        │   앙상블 예측     │
        │   (R² ≈ 0.68)   │
        └─────────────────┘
```

## 📋 피처 목록

### LightGBM 피처 (28개)
- **가격 지표**: 특_가격, 상_가격, lag7, lag14, MA7, MA30, RSI
- **수급 지표**: 총반입량, 수입중량, supply_pressure, import_dependency
- **외부 지표**: 유가_종가(USD)
- **계절성**: month_sin, month_cos, is_holiday_season, is_kimjang_season
- **지역별 기상**: 주산지_평균기온, 주산지_일교차, 생육기 기온/폭염/한파 등

### LSTM 피처 (12개)
- 특_가격, 상_가격
- 특_가격_lag7, 특_가격_MA7, 특_가격_MA30
- 상_가격_lag7, 상_가격_MA7
- 총반입량(ton), 유가_종가(USD)
- month_sin, month_cos, 주산지_평균기온

## 🚀 실행 방법

### 1. 패키지 설치

```bash
pip install -r requirements.txt
```

### 2. 모델 학습 및 예측

```bash
python model_lightgbm_lstm.py
```

### 3. 결과 확인
- `result_lgb_lstm_특_등급.png` - 특 등급 예측 그래프
- `result_lgb_lstm_상_등급.png` - 상 등급 예측 그래프

## 📈 데이터 소스

| 데이터 | 출처 | 기간 |
|--------|------|------|
| 양배추 도매가격 | 농넷 | 2016~2025 |
| 반입량 | 농넷 | 2016~2025 |
| 기상 데이터 | 기상청 | 2016~2025 |
| 유가 | Investing.com | 2016~2025 |
| 수출입 | Oasis | 2016~2025 |

## 🛠️ 기술 스택

- **언어**: Python 3.9+
- **ML**: LightGBM, Optuna (하이퍼파라미터 튜닝)
- **DL**: TensorFlow/Keras (Bi-LSTM)
- **데이터**: Pandas, NumPy, Scikit-learn

## 👥 팀원

- **건국대학교 KCSP**

